{% load i18n %}
{% comment %}
  Product Tile Attributes Component
  Displays up to 4 product attributes on product tiles (slider, grid, list views).
  The attributes are sorted by tile_display_order, then alphabetically.
  Only attributes with show_on_tile=True are displayed.
{% endcomment %}

{% with attrs=product.tile_display_attributes %}
{% if attrs %}
<div id="product-attributes-{{ product.id }}" class="product-tile-attributes mt-1.5 flex flex-col space-y-0.5">
  {% for attr in attrs %}
  {% if exclude_category_attribute and attr.attribute_name == 'Category' %}
    {# Category is rendered separately in some contexts (e.g. product detail) #}
  {% else %}
  <div class="product-tile-attribute flex items-baseline py-0.5 min-w-0">
    <a class="pointer-events-auto relative z-1 inline-flex items-baseline gap-1.5 cursor-pointer min-w-0 max-w-full {% if use_underline %}hover:underline underline-offset-4{% else %}border-b-2 border-transparent hover:border-primary-500/90 transition-none{% endif %}"
       href="{{ product.category.get_absolute_url }}?attr_{{ attr.attribute_id }}={{ attr.option_slug|urlencode }}"
       data-attr-id="{{ attr.attribute_id }}"
       data-option-slug="{{ attr.option_slug }}">
      <span class="shrink-0 text-sm font-normal text-gray-500 dark:text-gray-400">
        {{ attr.attribute_name }}:
      </span>
      <span class="min-w-0 truncate text-sm font-bold text-gray-900 dark:text-white"
            {% if attr.is_truncated %}
            title="{{ attr.full_value }}"
            data-tooltip-target="tooltip-attr-{{ product.id }}-{{ forloop.counter }}"
            {% endif %}>{{ attr.display_value }}</span>
    </a>
    
    {% if attr.is_truncated %}
    <div id="tooltip-attr-{{ product.id }}-{{ forloop.counter }}" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
      {{ attr.full_value }}
      <div class="tooltip-arrow" data-popper-arrow></div>
    </div>
    {% endif %}
  </div>
  {% endif %}
  {% endfor %}
</div>
{% endif %}
{% endwith %}
