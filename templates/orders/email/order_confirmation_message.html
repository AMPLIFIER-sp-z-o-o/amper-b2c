{% extends 'account/email/email_template_base.html' %}
{% load i18n %}

{% block title %}{% blocktranslate trimmed %}Order confirmation{% endblocktranslate %}{% endblock %}

{% block preheader %}{% blocktranslate trimmed with order_id=order.id %}Thanks for your order #{{ order_id }}.{% endblocktranslate %}{% endblock %}

{% block message_body %}
  <p style="margin: 0;">{% blocktranslate trimmed with name=order.full_name %}Hello {{ name }},{% endblocktranslate %}</p>
  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0;">{% blocktranslate trimmed with order_id=order.id %}Thank you for your order #{{ order_id }}.{% endblocktranslate %}</p>

  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0; font-weight: 700; color: #111827;">{% translate "Order summary" %}</p>
  <p style="margin: 0; color: #374151;">{% translate "Placed" %}: {{ order.created_at|date:"Y-m-d H:i" }}</p>

  <p style="margin: 0;">&nbsp;</p>

  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;">
    <thead>
      <tr>
        <th align="left" style="padding: 10px 0; border-bottom: 1px solid #e5e7eb; font-size: 13px; color: #6b7280; font-weight: 600;">{% translate "Item" %}</th>
        <th align="center" style="padding: 10px 0; border-bottom: 1px solid #e5e7eb; font-size: 13px; color: #6b7280; font-weight: 600;">{% translate "Qty" %}</th>
        <th align="right" style="padding: 10px 0; border-bottom: 1px solid #e5e7eb; font-size: 13px; color: #6b7280; font-weight: 600;">{% translate "Total" %}</th>
      </tr>
    </thead>
    <tbody>
      {% for line in lines %}
        <tr>
          <td style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">
            <div style="font-weight: 600; color: #111827;">{{ line.product.name }}</div>
            <div style="font-size: 12px; color: #6b7280;">{{ line.unit_price|floatformat:2 }} {{ currency_symbol }} {% translate "each" %}</div>
          </td>
          <td align="center" style="padding: 10px 0; border-bottom: 1px solid #f3f4f6; color: #111827;">{{ line.quantity }}</td>
          <td align="right" style="padding: 10px 0; border-bottom: 1px solid #f3f4f6; font-weight: 600; color: #111827;">{{ line.line_total|floatformat:2 }} {{ currency_symbol }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <p style="margin: 0;">&nbsp;</p>

  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;">
    <tbody>
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Subtotal" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.subtotal|floatformat:2 }} {{ currency_symbol }}</td>
      </tr>
      {% if order.discount_total and order.discount_total|floatformat:2 != "0.00" %}
        <tr>
          <td style="padding: 6px 0; color: #374151;">
            {% translate "Discount" %}{% if order.coupon_code %} <span style="color:#6b7280;">({% translate "Code" %}: {{ order.coupon_code }})</span>{% endif %}
          </td>
          <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">-{{ order.discount_total|floatformat:2 }} {{ currency_symbol }}</td>
        </tr>
      {% endif %}
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Delivery" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.delivery_cost|floatformat:2 }} {{ currency_symbol }}</td>
      </tr>
      <tr>
        <td style="padding: 10px 0; border-top: 1px solid #e5e7eb; color: #111827; font-weight: 700;">{% translate "Total" %}</td>
        <td align="right" style="padding: 10px 0; border-top: 1px solid #e5e7eb; color: #111827; font-weight: 700;">{{ order.total|floatformat:2 }} {{ currency_symbol }}</td>
      </tr>
    </tbody>
  </table>

  <p style="margin: 0;">&nbsp;</p>

  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;">
    <tbody>
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Delivery method" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.delivery_method_name|default:"-" }}</td>
      </tr>
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Payment method" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.payment_method_name|default:"-" }}</td>
      </tr>
    </tbody>
  </table>

  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0; font-weight: 700; color: #111827;">{% translate "Shipping details" %}</p>
  <p style="margin: 0; color: #374151;">
    {{ order.full_name }}<br />
    {{ order.shipping_address }}<br />
    {{ order.shipping_postal_code }} {{ order.shipping_city }}<br />
    {% if order.phone %}{% translate "Phone" %}: {{ order.phone }}{% endif %}
  </p>

  {% if payment_url %}
    <p style="margin: 0;">&nbsp;</p>
    <p style="margin: 0; color: #374151;">{% translate "Payment is required to complete your order." %}</p>
  {% endif %}

  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0; color: #6b7280; font-size: 12px;">
    {% translate "Tracking link" %}: <a href="{{ tracking_url }}" target="_blank" style="color:#1A56DB; text-decoration:underline;">{{ tracking_url }}</a>
  </p>
{% endblock %}

{% block cta_link %}{{ cta_url }}{% endblock %}
{% block cta_text %}{{ cta_text }}{% endblock %}
