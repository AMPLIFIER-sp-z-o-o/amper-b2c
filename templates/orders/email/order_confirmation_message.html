{% extends 'account/email/email_template_base.html' %}
{% load i18n %}

{% block title %}{% blocktranslate trimmed %}Order confirmation{% endblocktranslate %}{% endblock %}

{% block preheader %}{% blocktranslate trimmed with order_id=order.id %}Thanks for your order #{{ order_id }}.{% endblocktranslate %}{% endblock %}

{% block message_body %}
  <p style="margin: 0;">{% blocktranslate trimmed with name=order.full_name %}Hello {{ name }},{% endblocktranslate %}</p>
  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0;">{% blocktranslate trimmed with order_id=order.id %}Thank you for placing your order #{{ order_id }}. We have received it and are preparing it for shipment.{% endblocktranslate %}</p>

  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0; font-weight: 700; color: #111827;">{% translate "Order summary" %}</p>
  <p style="margin: 0; color: #374151;">{% translate "Placed" %}: {{ order.created_at|date:"Y-m-d H:i" }}</p>

  <p style="margin: 0;">&nbsp;</p>

  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;">
    <thead>
      <tr>
        <th align="left" style="padding: 10px 0; border-bottom: 1px solid #e5e7eb; font-size: 13px; color: #6b7280; font-weight: 600;" colspan="2">{% translate "Item" %}</th>
        <th align="center" style="padding: 10px 0; border-bottom: 1px solid #e5e7eb; font-size: 13px; color: #6b7280; font-weight: 600; width: 80px;">{% translate "Quantity" %}</th>
        <th align="right" style="padding: 10px 0; border-bottom: 1px solid #e5e7eb; font-size: 13px; color: #6b7280; font-weight: 600; width: 90px;">{% translate "Total" %}</th>
      </tr>
    </thead>
    <tbody>
      {% for line in lines %}
        <tr>
          <td width="60" style="padding: 10px 10px 10px 0; border-bottom: 1px solid #f3f4f6;">
            {% with primary_image=line.product.images.first %}
              {% if primary_image and primary_image.image %}
                {% if primary_image.image.url|slice:":4" == "http" %}
                  <img src="{{ primary_image.image.url }}" alt="{{ primary_image.alt_text|default:line.product.name }}" width="50" style="max-width: 50px; height: auto; border-radius: 4px; display: block;" />
                {% else %}
                  <img src="{{ site_url }}{{ primary_image.image.url }}" alt="{{ primary_image.alt_text|default:line.product.name }}" width="50" style="max-width: 50px; height: auto; border-radius: 4px; display: block;" />
                {% endif %}
              {% endif %}
            {% endwith %}
          </td>
          <td style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">
            <div style="font-weight: 600;">
               <a href="{{ site_url }}{{ line.product.get_absolute_url }}" target="_blank" style="color: #111827; text-decoration: none;">{{ line.product.name }}</a>
            </div>
            <div style="font-size: 12px; color: #6b7280;">{{ line.unit_price|floatformat:2 }} {{ currency_symbol }} {% translate "each" %}</div>
          </td>
          <td align="center" style="padding: 10px 0; border-bottom: 1px solid #f3f4f6; color: #111827;">{{ line.quantity }}</td>
          <td align="right" style="padding: 10px 0; border-bottom: 1px solid #f3f4f6; font-weight: 600; color: #111827;">{{ line.line_total|floatformat:2 }} {{ currency_symbol }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <p style="margin: 0;">&nbsp;</p>

  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;">
    <tbody>
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Subtotal" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.subtotal|floatformat:2 }} {{ currency_symbol }}</td>
      </tr>
      {% if order.discount_total and order.discount_total|floatformat:2 != "0.00" %}
        <tr>
          <td style="padding: 6px 0; color: #374151;">
            {% translate "Discount" %}{% if order.coupon_code %} <span style="color:#6b7280;">({% translate "Code" %}: {{ order.coupon_code }})</span>{% endif %}
          </td>
          <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">-{{ order.discount_total|floatformat:2 }} {{ currency_symbol }}</td>
        </tr>
      {% endif %}
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Delivery" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.delivery_cost|floatformat:2 }} {{ currency_symbol }}</td>
      </tr>
      <tr>
        <td style="padding: 10px 0; border-top: 1px solid #e5e7eb; color: #111827; font-weight: 700;">{% translate "Total" %}</td>
        <td align="right" style="padding: 10px 0; border-top: 1px solid #e5e7eb; color: #111827; font-weight: 700;">{{ order.total|floatformat:2 }} {{ currency_symbol }}</td>
      </tr>
    </tbody>
  </table>

  <p style="margin: 0;">&nbsp;</p>

  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;">
    <tbody>
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Delivery method" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.delivery_method_name|default:"-" }}</td>
      </tr>
      <tr>
        <td style="padding: 6px 0; color: #374151;">{% translate "Payment method" %}</td>
        <td align="right" style="padding: 6px 0; color: #111827; font-weight: 600;">{{ order.payment_method_name|default:"-" }}</td>
      </tr>
    </tbody>
  </table>

  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0; font-weight: 700; color: #111827;">{% translate "Shipping details" %}</p>
  <p style="margin: 0; color: #374151;">
    {{ order.full_name }}<br />
    {{ order.shipping_address }}<br />
    {{ order.shipping_postal_code }} {{ order.shipping_city }}<br />
    {% if order.phone %}{% translate "Phone" %}: {{ order.phone }}{% endif %}
  </p>

  <p style="margin: 0;">&nbsp;</p>
  <p style="margin: 0;">
    <strong style="color: #111827;">{% translate "Track your order" %}:</strong>
  </p>
  <p style="margin: 4px 0 0 0;">
    <a href="{{ tracking_url }}" target="_blank" style="color:#1A56DB; font-size: 14px; font-weight: 600; text-decoration: underline; word-break: break-all;">{{ tracking_url }}</a>
  </p>
{% endblock %}

{% block cta %}{% endblock %}
